# Values file for production environment

nifi:
  enabled: true
  cluster:
    nodeCount: 5  # More nodes for production (used if autoscaling disabled)
    autoscaling:
      enabled: true  # Enable autoscaling in production
      minReplicas: 5
      maxReplicas: 20
      targetCPUUtilizationPercentage: 70
      targetMemoryUtilizationPercentage: 80
      behavior:
        scaleDown:
          stabilizationWindowSeconds: 300
          policies:
          - type: Percent
            value: 50
            periodSeconds: 60
        scaleUp:
          stabilizationWindowSeconds: 0
          policies:
          - type: Percent
            value: 100
            periodSeconds: 60
          - type: Pods
            value: 2
            periodSeconds: 60
          selectPolicy: Max
    zookeeper:
      enabled: true
      replicas: 5  # More ZooKeeper nodes for production
      resources:
        requests:
          cpu: 500m
          memory: 512Mi
        limits:
          cpu: 1000m
          memory: 1Gi
  resources:
    requests:
      cpu: 2000m
      memory: 4Gi
    limits:
      cpu: 4000m
      memory: 8Gi
  storage:
    size: 100Gi  # More storage for production
  keycloak:
    enabled: true
    url: "https://keycloak.production.local/auth"
    realm: "data-platform"
    clientId: "nifi"
  security:
    enabled: true
    ssl:
      enabled: true

nifiRegistry:
  enabled: true
  replicas: 3  # HA for production
  resources:
    requests:
      cpu: 1000m
      memory: 2Gi
    limits:
      cpu: 2000m
      memory: 4Gi
  storage:
    size: 50Gi
  database:
    type: postgresql
    postgresql:
      host: "postgresql.production.svc.cluster.local"
      port: 5432
      database: "nifi_registry"
      username: "nifi_registry"
      ssl: true
  keycloak:
    enabled: true
    url: "https://keycloak.production.local/auth"
    realm: "data-platform"
    clientId: "nifi-registry"

secrets:
  keycloak:
    create: true
  database:
    create: true
  ssl:
    create: true

